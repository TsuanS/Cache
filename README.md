
## 项目介绍
本项目使用多个页面替换策略实现一个线程安全的缓存：
- LRU：最近最久未使用
- LFU：最近不经常使用
- ARC：自适应替换

对于LRU和LFU策略，我在其基础的缓存策略上进行了相应的优化，例如：

- LRU优化：
    - LRU分片：对多线程下的高并发访问有性能上的优化
    - LRU-k：一定程度上防止热点数据被冷数据挤出容器而造成缓存污染等问题
    - LRU-k分片

- LFU优化：
    - LFU分片：对多线程下的高并发访问有性能上的优化
    - 引入最大平均访问频次：解决过去的热点数据最近一直没被访问，却仍占用缓存等问题

## 系统环境 

    Ubuntu 22.04 LTS

## 编译
创建一个build文件夹并进入
```
mkdir build && cd build
```
生成构建文件
```
cmake ..
```
构建项目
```
make
```
如果要清理生成的可执行文件
```
make clean
```

## 运行
```
./main
```

## 测试结果
不同缓存策略缓存命中率测试对比结果如下：
（ps: 该测试代码只是尽可能地模拟真实的访问场景，但是跟真实的场景仍存在一定差距，测试结果仅供参考。）


### 测试用例 1 - 标准负载

=== 测试场景1：热点数据访问测试 ===

缓存大小: 50

LRU - 命中率: 70.17%

LFU - 命中率: 3.75%

ARC - 命中率: 70.17%

LRU-K - 命中率: 70.00%

Hash-LRU - 命中率: 52.78%

Hash-LRU-K - 命中率: 70.00%

Hash-LFU - 命中率: 14.37%


=== 测试场景2：循环扫描测试 ===

缓存大小: 50

LRU - 命中率: 9.03%

LFU - 命中率: 8.98%

ARC - 命中率: 9.03%

LRU-K - 命中率: 0.00%

Hash-LRU - 命中率: 9.40%

Hash-LRU-K - 命中率: 0.00%

Hash-LFU - 命中率: 9.31%


=== 测试场景3：工作负载剧烈变化测试 ===

缓存大小: 50

LRU - 命中率: 52.80%

LFU - 命中率: 25.67%

ARC - 命中率: 55.84%

LRU-K - 命中率: 45.01%

Hash-LRU - 命中率: 54.04%

Hash-LRU-K - 命中率: 45.91%

Hash-LFU - 命中率: 28.32%


### 测试用例 2 - 小容量高操作


=== 测试场景1：热点数据访问测试 ===

缓存大小: 20

LRU - 命中率: 0.06%

LFU - 命中率: 2.88%

ARC - 命中率: 12.63%

LRU-K - 命中率: 27.88%

Hash-LRU - 命中率: 0.06%

Hash-LRU-K - 命中率: 29.33%

Hash-LFU - 命中率: 5.65%


=== 测试场景2：循环扫描测试 ===

缓存大小: 20

LRU - 命中率: 8.99%

LFU - 命中率: 8.97%

ARC - 命中率: 8.53%

LRU-K - 命中率: 0.00%

Hash-LRU - 命中率: 9.04%

Hash-LRU-K - 命中率: 0.00%

Hash-LFU - 命中率: 9.01%


=== 测试场景3：工作负载剧烈变化测试 ===

缓存大小: 20

LRU - 命中率: 45.26%

LFU - 命中率: 22.44%

ARC - 命中率: 49.65%

LRU-K - 命中率: 35.74%

Hash-LRU - 命中率: 45.70%

Hash-LRU-K - 命中率: 45.09%

Hash-LFU - 命中率: 27.56%

### 测试用例 3 - 大容量低操作

=== 测试场景1：热点数据访问测试 ===

缓存大小: 200

LRU - 命中率: 71.59%

LFU - 命中率: 21.12%

ARC - 命中率: 71.85%

LRU-K - 命中率: 70.00%

Hash-LRU - 命中率: 71.61%

Hash-LRU-K - 命中率: 70.00%

Hash-LFU - 命中率: 26.42%


=== 测试场景2：循环扫描测试 ===

缓存大小: 200

LRU - 命中率: 17.95%

LFU - 命中率: 18.06%

ARC - 命中率: 18.02%

LRU-K - 命中率: 0.00%

Hash-LRU - 命中率: 18.02%

Hash-LRU-K - 命中率: 0.00%

Hash-LFU - 命中率: 18.04%


=== 测试场景3：工作负载剧烈变化测试 ===

缓存大小: 200

LRU - 命中率: 74.85%

LFU - 命中率: 47.46%

ARC - 命中率: 79.21%

LRU-K - 命中率: 47.13%

Hash-LRU - 命中率: 74.65%

Hash-LRU-K - 命中率: 46.90%

Hash-LFU - 命中率: 32.06%


### 测试用例 4 - 高热点比例


=== 测试场景1：热点数据访问测试 ===

缓存大小: 100

LRU - 命中率: 37.20%

LFU - 命中率: 5.64%

ARC - 命中率: 60.44%

LRU-K - 命中率: 70.00%

Hash-LRU - 命中率: 36.39%

Hash-LRU-K - 命中率: 2.79%

Hash-LFU - 命中率: 7.02%


=== 测试场景2：循环扫描测试 ===

缓存大小: 100

LRU - 命中率: 18.00%

LFU - 命中率: 18.06%

ARC - 命中率: 17.26%

LRU-K - 命中率: 0.00%

Hash-LRU - 命中率: 17.98%

Hash-LRU-K - 命中率: 0.00%

Hash-LFU - 命中率: 18.01%


=== 测试场景3：工作负载剧烈变化测试 ===

缓存大小: 100

LRU - 命中率: 69.59%

LFU - 命中率: 30.02%

ARC - 命中率: 72.18%

LRU-K - 命中率: 47.48%

Hash-LRU - 命中率: 69.39%

Hash-LRU-K - 命中率: 48.21%

Hash-LFU - 命中率: 30.93%


### 测试用例 5 - 高冷数据比例


=== 测试场景1：热点数据访问测试 ===

缓存大小: 50

LRU - 命中率: 70.12%

LFU - 命中率: 7.19%

ARC - 命中率: 70.14%

LRU-K - 命中率: 70.00%

Hash-LRU - 命中率: 56.08%

Hash-LRU-K - 命中率: 70.00%

Hash-LFU - 命中率: 28.09%


=== 测试场景2：循环扫描测试 ===

缓存大小: 50

LRU - 命中率: 9.03%

LFU - 命中率: 9.03%

ARC - 命中率: 8.63%

LRU-K - 命中率: 0.00%

Hash-LRU - 命中率: 9.39%

Hash-LRU-K - 命中率: 0.00%

Hash-LFU - 命中率: 9.39%


=== 测试场景3：工作负载剧烈变化测试 ===

缓存大小: 50

LRU - 命中率: 52.99%

LFU - 命中率: 25.78%

ARC - 命中率: 53.81%

LRU-K - 命中率: 44.99%

Hash-LRU - 命中率: 53.72%

Hash-LRU-K - 命中率: 45.78%

Hash-LFU - 命中率: 29.19%


### 测试用例 6 - 大容量高操作


=== 测试场景1：热点数据访问测试 ===

缓存大小: 500

LRU - 命中率: 71.20%

LFU - 命中率: 18.25%

ARC - 命中率: 71.39%

LRU-K - 命中率: 70.00%

Hash-LRU - 命中率: 71.19%

Hash-LRU-K - 命中率: 0.00%

Hash-LFU - 命中率: 20.36%


=== 测试场景2：循环扫描测试 ===

缓存大小: 500

LRU - 命中率: 22.58%

LFU - 命中率: 22.62%

ARC - 命中率: 22.07%

LRU-K - 命中率: 0.00%

Hash-LRU - 命中率: 22.43%

Hash-LRU-K - 命中率: 0.00%

Hash-LFU - 命中率: 22.50%


=== 测试场景3：工作负载剧烈变化测试 ===

缓存大小: 500

LRU - 命中率: 84.64%

LFU - 命中率: 85.67%

ARC - 命中率: 89.75%

LRU-K - 命中率: 46.12%

Hash-LRU - 命中率: 84.14%

Hash-LRU-K - 命中率: 44.41%

Hash-LFU - 命中率: 85.30%


### 测试用例 7 - 高频率变化


=== 测试场景1：热点数据访问测试 ===

缓存大小: 50

LRU - 命中率: 28.45%

LFU - 命中率: 3.55%

ARC - 命中率: 57.55%

LRU-K - 命中率: 70.00%

Hash-LRU - 命中率: 29.83%

Hash-LRU-K - 命中率: 70.00%

Hash-LFU - 命中率: 6.33%


=== 测试场景2：循环扫描测试 ===

缓存大小: 50

LRU - 命中率: 8.96%

LFU - 命中率: 9.02%

ARC - 命中率: 9.02%

LRU-K - 命中率: 0.00%

Hash-LRU - 命中率: 9.36%

Hash-LRU-K - 命中率: 0.00%

Hash-LFU - 命中率: 9.41%


=== 测试场景3：工作负载剧烈变化测试 ===

缓存大小: 50

LRU - 命中率: 57.03%

LFU - 命中率: 30.43%

ARC - 命中率: 56.62%

LRU-K - 命中率: 47.82%

Hash-LRU - 命中率: 58.28%

Hash-LRU-K - 命中率: 48.45%

Hash-LFU - 命中率: 34.18%


### 测试用例 8 - 长时间访问测试


=== 测试场景1：热点数据访问测试 ===

缓存大小: 150

LRU - 命中率: 70.73%

LFU - 命中率: 19.48%

ARC - 命中率: 70.76%

LRU-K - 命中率: 70.00%

Hash-LRU - 命中率: 70.72%

Hash-LRU-K - 命中率: 70.00%

Hash-LFU - 命中率: 14.82%


=== 测试场景2：循环扫描测试 ===

缓存大小: 150

LRU - 命中率: 13.47%

LFU - 命中率: 13.50%

ARC - 命中率: 13.39%

LRU-K - 命中率: 0.00%

Hash-LRU - 命中率: 13.71%

Hash-LRU-K - 命中率: 0.00%

Hash-LFU - 命中率: 13.66%


=== 测试场景3：工作负载剧烈变化测试 ===

缓存大小: 150

LRU - 命中率: 77.04%

LFU - 命中率: 38.50%

ARC - 命中率: 80.77%

LRU-K - 命中率: 42.17%

Hash-LRU - 命中率: 77.25%

Hash-LRU-K - 命中率: 44.61%

Hash-LFU - 命中率: 37.73%


### 测试用例 9 - 高并发访问


=== 测试场景1：热点数据访问测试 ===

缓存大小: 200

LRU - 命中率: 70.90%

LFU - 命中率: 13.76%

ARC - 命中率: 71.02%

LRU-K - 命中率: 70.01%

Hash-LRU - 命中率: 69.50%

Hash-LRU-K - 命中率: 70.00%

Hash-LFU - 命中率: 23.49%


=== 测试场景2：循环扫描测试 ===

缓存大小: 200

LRU - 命中率: 17.98%

LFU - 命中率: 17.98%

ARC - 命中率: 17.64%

LRU-K - 命中率: 0.00%

Hash-LRU - 命中率: 17.94%

Hash-LRU-K - 命中率: 0.00%

Hash-LFU - 命中率: 17.95%


=== 测试场景3：工作负载剧烈变化测试 ===

缓存大小: 200

LRU - 命中率: 79.69%

LFU - 命中率: 49.36%

ARC - 命中率: 83.17%

LRU-K - 命中率: 50.31%

Hash-LRU - 命中率: 79.71%

Hash-LRU-K - 命中率: 50.46%

Hash-LFU - 命中率: 44.29%


### 测试用例 10 - 更长操作次数与更低容量


=== 测试场景1：热点数据访问测试 ===

缓存大小: 30

LRU - 命中率: 0.45%

LFU - 命中率: 3.94%

ARC - 命中率: 56.24%

LRU-K - 命中率: 70.14%

Hash-LRU - 命中率: 14.43%

Hash-LRU-K - 命中率: 70.00%

Hash-LFU - 命中率: 14.40%


=== 测试场景2：循环扫描测试 ===

缓存大小: 30

LRU - 命中率: 5.41%

LFU - 命中率: 5.40%

ARC - 命中率: 5.39%

LRU-K - 命中率: 0.00%

Hash-LRU - 命中率: 5.77%

Hash-LRU-K - 命中率: 0.00%

Hash-LFU - 命中率: 5.76%


=== 测试场景3：工作负载剧烈变化测试 ===

缓存大小: 30

LRU - 命中率: 50.30%

LFU - 命中率: 28.62%

ARC - 命中率: 47.73%

LRU-K - 命中率: 44.10%

Hash-LRU - 命中率: 51.80%

Hash-LRU-K - 命中率: 47.32%

Hash-LFU - 命中率: 32.59%

